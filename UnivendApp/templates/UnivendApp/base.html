{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniVend - {% block title %}Campus Marketplace{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    {% block stylesheet %}
        <link href="{% static 'css/homepage-style.css' %}" rel="stylesheet">
    {% endblock %}
    {% block extra_head %}
    {% endblock %}
</head>
<body>
    <!-- Top Bar Block -->
    {% block top_bar %}
        <div class="top-bar">
            <div class="location-selector">
                <span class="material-icons-round">location_on</span>
                <select class="campus-select" id="campusSelect" onchange="handleSelectChange(this)">
                    <option>{{ campus.name|default:"Select Campus" }}</option>
                    <option value="logout" style="color:red; font-weight:bold;">Logout</option>
                </select>
            </div>
            <a href="{% url 'profile' %}" class="profile-icon">
                <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}https://i.pravatar.cc/150?img=11{% endif %}" 
                     alt="Profile" class="avatar">
            </a>
        </div>
    {% endblock %}

    <!-- Messages -->
    {% comment %} {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %} {% endcomment %}

    <!-- Main Content Block -->
    {% block content %}
    {% endblock %}

    <!-- Bottom Navigation Block -->
    {% block bottom_nav %}
        <nav class="bottom-nav" style="text-decoration: none;">
            <a href="{% url 'home' %}" class="nav-item{% if request.path == '/home/' %} active{% endif %}" style="text-decoration: none;">
                <span class="material-icons-round">home</span>
                <span class="nav-text">Home</span>
            </a>
            <a href="{% url 'explore' %}" class="nav-item{% if request.path == '/explore/' %} active{% endif %}" style="text-decoration: none;">
                <span class="material-icons-round">explore</span>
                <span class="nav-text">Explore</span>
            </a>
            <a href="{% url 'add-listing' %}" class="nav-item" style="text-decoration: none;">
                <div class="add-button">
                    <span class="material-icons-round">add</span>
                </div>
            </a>
            <a href="{% url 'chat-list' %}" class="nav-item{% if request.path == '/chat-list/' %} active{% endif %}" style="text-decoration: none;">
                <span class="material-icons-round">chat</span>
                <span class="nav-text">Messages</span>
            </a>
            <a href="{% url 'profile' %}" class="nav-item{% if request.path == '/profile/' %} active{% endif %}" style="text-decoration: none;">
                <span class="material-icons-round">person</span>
                <span class="nav-text">Profile</span>
            </a>
        </nav>
    {% endblock %}

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}
    {% endblock %}
    <script>
        function handleSelectChange(select) {
            if (select.value === "logout") {
                window.location.href = "{% url 'logout_user' %}";
            }
        }
    </script>
    {% block extra_scripts %}
    {% endblock %}
</body>
</html>